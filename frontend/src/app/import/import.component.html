<div class="p-4">
  <!-- Section 1: Fiche Portefeuille -->
  <div class="flex flex-wrap items-center gap-3 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow mb-6">
    <h2 class="text-sm font-medium text-gray-900 dark:text-white whitespace-nowrap">
      Import Fiche Portefeuille File
    </h2>
    <input
      id="file_input"
      type="file"
      (change)="onFileSelected($event)"
      class="text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer
             bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700
             dark:border-gray-600 dark:placeholder-gray-400"
    />
    <button
      (click)="onUpload()"
      class="text-sm text-white bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-lg transition-colors"
    >
      Fiche_Portefeuille
    </button>
    <span *ngIf="uploadMessage" class="text-sm" [ngClass]="uploadMessage.includes('Error') ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400'">
      {{ uploadMessage }}
    </span>
  </div>
  <div *ngIf="uploadProgress > 0" class="mb-6">
    <p class="text-sm text-gray-700 dark:text-gray-300">Progress: {{ uploadProgress }}%</p>
  </div>

  <!-- Section 2: Categorie Upload -->
  <div class="flex flex-wrap items-center gap-3 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow mb-6">
    <h2 class="text-sm font-medium text-gray-900 dark:text-white whitespace-nowrap">
      Import Categorie Excel File
    </h2>
    <input
      id="categorie_file_input"
      type="file"
      (change)="onCategorieFileSelected($event)"
      class="text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer
             bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700
             dark:border-gray-600 dark:placeholder-gray-400"
    />
    <button
      (click)="onUploadCategorie()"
      class="text-sm text-white bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg transition-colors"
    >
      Categorie
    </button>
    <span *ngIf="uploadCategorieMessage" class="text-sm" [ngClass]="uploadCategorieMessage.includes('Error') ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400'">
      {{ uploadCategorieMessage }}
    </span>
  </div>
  <div *ngIf="uploadCategorieProgress > 0" class="mb-6">
    <p class="text-sm text-gray-700 dark:text-gray-300">Progress: {{ uploadCategorieProgress }}%</p>
  </div>

  <!-- Section 3: ReferentielTitre Upload -->
  <div class="flex flex-wrap items-center gap-3 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow mb-6">
    <h2 class="text-sm font-medium text-gray-900 dark:text-white whitespace-nowrap">
      Import ReferentielTitre Excel File
    </h2>
    <input
      id="referentiel_file_input"
      type="file"
      (change)="onReferentielTitreFileSelected($event)"
      class="text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer
             bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700
             dark:border-gray-600 dark:placeholder-gray-400"
    />
    <button
      (click)="onUploadReferentielTitre()"
      class="text-sm text-white bg-purple-500 hover:bg-purple-600 px-4 py-2 rounded-lg transition-colors"
    >
      ReferentielTitre
    </button>
    <span *ngIf="uploadReferentielTitreMessage" class="text-sm" [ngClass]="uploadReferentielTitreMessage.includes('Error') ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400'">
      {{ uploadReferentielTitreMessage }}
    </span>
  </div>
  <div *ngIf="uploadReferentielTitreProgress > 0" class="mb-6">
    <p class="text-sm text-gray-700 dark:text-gray-300">Progress: {{ uploadReferentielTitreProgress }}%</p>
  </div>

  <!-- Section 4: Transparisation Upload -->
  <div class="flex flex-wrap items-center gap-3 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow mb-6">
    <h2 class="text-sm font-medium text-gray-900 dark:text-white whitespace-nowrap">
      Import Transparisation Excel File
    </h2>
    <input
      id="transparisation_file_input"
      type="file"
      (change)="onTransparisationFileSelected($event)"
      class="text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer
             bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700
             dark:border-gray-600 dark:placeholder-gray-400"
    />
    <button
      (click)="onUploadTransparisation()"
      class="text-sm text-white bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg transition-colors"
    >
      Transparisation
    </button>
    <span *ngIf="uploadTransparisationMessage" class="text-sm" [ngClass]="uploadTransparisationMessage.includes('Error') ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400'">
      {{ uploadTransparisationMessage }}
    </span>
  </div>
  <div *ngIf="uploadTransparisationProgress > 0" class="mb-6">
    <p class="text-sm text-gray-700 dark:text-gray-300">Progress: {{ uploadTransparisationProgress }}%</p>
  </div>

  <!-- Section 5: Op Upload -->
  <div class="flex flex-wrap items-center gap-3 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg shadow">
    <h2 class="text-sm font-medium text-gray-900 dark:text-white whitespace-nowrap">
      Import Op Excel File
    </h2>
    <input
      id="op_file_input"
      type="file"
      (change)="onOpFileSelected($event)"
      class="text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer
             bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700
             dark:border-gray-600 dark:placeholder-gray-400"
    />
    <button
      (click)="onUploadOp()"
      class="text-sm text-white bg-indigo-500 hover:bg-indigo-600 px-4 py-2 rounded-lg transition-colors"
    >
      Op
    </button>
    <span *ngIf="uploadOpMessage" class="text-sm" [ngClass]="uploadOpMessage.includes('Error') ? 'text-red-600 dark:text-red-400' : 'text-green-600 dark:text-green-400'">
      {{ uploadOpMessage }}
    </span>
  </div>
  <div *ngIf="uploadOpProgress > 0" class="mb-6">
    <p class="text-sm text-gray-700 dark:text-gray-300">Progress: {{ uploadOpProgress }}%</p>
  </div>
</div>
